---
title: "Reproduction, Life Expectancy"
author: "Pachia Lee"
date: "`r Sys.Date()`"
---
```{r}
library(tidyverse)
library(janitor)
library(lubridate)
library(RColorBrewer)
#library(paletteer)
```

```{r}
#install.packages("RColorBrewer")
#install.packages("paletteer")
#install.packages("ggthemes")
```

Loading data
```{r}
ecosphere<- read_csv("ecosphere.csv") %>% clean_names()
```

```{r}
options(scipen = 999)
```



Structure of Data
```{r}
summary(ecosphere)
```

```{r}
names(ecosphere)
```
```{r}
display.brewer.pal(10,"PuBuGn") #sequential palette
```



##Create a plot that compares the top ten families and their population sizes
```{r}
ecosphere %>% 
  count(family)
```

```{r}
ecosphere %>% 
  filter(family=="Emberizidae")
```

```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>%
  ggplot(aes(x = common_name, y = population_size, fill=common_name)) +
  geom_col() +
  coord_flip()
  scale_fill_brewer(palette ="PuBuGn")+
  theme(legend.position = "top",
        axis.text.x = element_text(angle = 60, hjust=1))+
  labs(title = "Population Size of Emberizidae Family",
       y = "Population Size") 
```


##Create a plot that compares Emberizidae and life expectancy ranges
```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>% 
  group_by(life_expectancy) %>% 
  summarize(n=n())
```

```{r}
ecosphere %>% 
  ggplot(aes(x=life_expectancy, fill=life_expectancy))+
  geom_bar(color="black")+
  scale_fill_brewer(palette = "PuBuGn")+
  labs(title = "Life Expectancy Ranges of the Family Emberizidae ",
       x = "Common Name",
       y = "Life Expectancy")
```


```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>% 
  ggplot(aes(x = common_name, y = life_expectancy, fill=life_expectancy)) +
  geom_col() +
  scale_fill_brewer(palette = "PuBuGn")+
  labs(title = "Life Expectancy Ranges of the Family Emberizidae ",
       x = "Common Name",
       y = "Life Expectancy") +
  theme(axis.text.x=element_text(size=12),axis.text.y = element_text(size = 6))+
  coord_flip()
```

```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>% 
  group_by(life_expectancy) %>% 
  summarize(n=n())
```

```{r}
ecosphere %>% 
  group_by(family) %>% 
  summarize(n=n())  %>% 
  top_n(5) %>% 
  arrange(desc(n))
  
```

```{r}
ecosphere %>% 
  filter(family==c("Anatidae", "Emberizidae", "Parulidae", "Scolopacidae", "Picidae", "Tyrannidae")) %>% 
  group_by(family) %>% 
  summarize(mean_eggs_family=mean(mean_eggs_per_clutch, na.rm=T))
```

```{r}
ecosphere %>% 
  filter(family==c("Anatidae", "Emberizidae", "Parulidae", "Scolopacidae", "Picidae", "Tyrannidae")) %>% 
  ggplot(aes(x=family, y=mean_eggs_per_clutch, fill=family))+
   scale_fill_brewer(palette = "PuBuGn")+
  geom_boxplot()
```

```{r}
ecosphere %>% 
  filter(family==c("Anatidae", "Emberizidae", "Parulidae")) %>% 
  ggplot(aes(x=mean_eggs_per_clutch, fill=family))+
  geom_density(alpha=0.5)+
   scale_fill_brewer(palette = "PuBuGn")
  
```


```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>% 
  ggplot(aes(x=mean_eggs_per_clutch, fill=family))+
  geom_density(alpha=0.6)+
   scale_fill_brewer(palette = "PuBuGn")
  
```

```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>% 
  ggplot(aes(x = common_name, y = mean_eggs_per_clutch , fill=mean_eggs_per_clutch)) +
  geom_col() +
  scale_color_continuous(palette = "PuBuGn")+ #I changed "scale_color_brewer" to "scale_color_continuous" bc that's what CHATGPT said
  coord_flip()+
  labs(title = "Mean Eggs per Clutch in the Family Emberizidae ",
       x = "Common Name",
       y = "Mean Eggs Per Clutch") +
  theme(axis.text.x=element_text(size=12),axis.text.y = element_text(size = 6))
```

```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>% 
  ggplot(aes(x = reorder(common_name, mean_age_at_sexual_maturity), y = mean_age_at_sexual_maturity, fill=mean_age_at_sexual_maturity)) +
  geom_col()+
  scale_color_brewer(palette ="PuBuGn")+
  coord_flip()+
  labs(title = "Mean Age of Sexual Maturity in Emberizidae ",
       x = "Common Name",
       y = "Ages") +
  theme(axis.text.x=element_text(size=12),axis.text.y = element_text(size = 6))
```

```{r}
ecosphere %>% 
  filter(family=="Emberizidae") %>% 
  ggplot(aes(x = life_expectancy, y = mean_eggs_per_clutch, color=common_name)) +
  geom_col()+
  scale_colour_brewer(palette = "PuBuGn")+
  labs(title="How long birds lived and ")
```


